/* ─── Variables ──────────────────────────────────────────────── */
:root {
    --font-body: 'Public Sans', system-ui, sans-serif;

    --bg: #121212;
    --bg-card: #1e1e1e;
    --bg-subtle: #2c2c2c;

    --text: #e0e0e0;
    --text-muted: #c0c0c0;
    --text-light: #6c757d;

    --border: rgba(255, 255, 255, 0.1);
    --border-light: rgba(255, 255, 255, 0.07);
    --border-hover: rgba(255, 255, 255, 0.2);

    --tesco: #00539f;
    --tesco-light: rgba(0, 83, 159, 0.2);
    --sainsburys: #f06c00;
    --sainsburys-light: rgba(240, 108, 0, 0.2);
    --aldi: #00205b;
    --aldi-light: rgba(0, 32, 91, 0.2);
    --asda: #78b73d;
    --asda-light: rgba(120, 183, 61, 0.2);
    --morrisons: #005a2b;
    --morrisons-light: rgba(0, 90, 43, 0.2);
    --waitrose: #5e8e3e;
    --waitrose-light: rgba(94, 142, 62, 0.2);
    --ocado: #5a287d;
    --ocado-light: rgba(90, 40, 125, 0.2);
    --coop: #00b1e7;
    --coop-light: rgba(0, 177, 231, 0.2);

    --accent: #ff7e47;
    --accent-hover: #e56830;
    --accent-light: rgba(255, 126, 71, 0.15);

    --cheapest: #d4a017;
    --cheapest-bg: rgba(212, 160, 23, 0.12);

    --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
    --shadow-lg: 0 12px 32px rgba(0,0,0,0.5);

    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;
}

/* ─── Reset & Base ───────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

body {
    font-family: var(--font-body);
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
}

.app { max-width: 960px; margin: 0 auto; padding: 0 20px; }

/* ─── Header ─────────────────────────────────────────────────── */
.header { padding: 32px 0 24px; text-align: center; }
.header__back {
    display: inline-block; font-size: 13px; color: var(--text-light);
    text-decoration: none; margin-bottom: 12px; transition: color 0.2s;
}
.header__back:hover { color: var(--accent); }

.logo { display: flex; align-items: center; justify-content: center; gap: 10px; }
.logo__icon { font-size: 28px; }
.logo__text { font-size: 28px; font-weight: 700; letter-spacing: -0.02em; color: var(--text); }
.logo__accent { color: var(--accent); }
.header__tagline { margin-top: 6px; font-size: 14px; color: var(--text-muted); letter-spacing: 0.01em; }

/* ─── Search ─────────────────────────────────────────────────── */
.search-section { padding: 8px 0 32px; }
.search-box {
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-xl); padding: 6px;
    box-shadow: var(--shadow-md); transition: box-shadow 0.3s ease, border-color 0.3s ease;
}
.search-box:focus-within { box-shadow: var(--shadow-lg); border-color: var(--accent); }

.search-box__input-wrap { display: flex; align-items: center; gap: 8px; }
.search-box__icon { width: 22px; height: 22px; margin-left: 16px; color: var(--text-light); flex-shrink: 0; }
.search-box__input {
    flex: 1; border: none; outline: none; background: transparent;
    font-family: var(--font-body); font-size: 16px; color: var(--text); padding: 14px 4px;
}
.search-box__input::placeholder { color: var(--text-light); }
.search-box__btn {
    background: var(--accent); color: #ffffff; border: none;
    border-radius: calc(var(--radius-xl) - 4px);
    padding: 12px 28px; font-family: var(--font-body); font-size: 15px;
    font-weight: 600; cursor: pointer; transition: background 0.2s ease, transform 0.15s ease; flex-shrink: 0;
}
.search-box__btn:hover { background: var(--accent-hover); }
.search-box__btn:active { transform: scale(0.97); }

.search-box__hints { display: flex; align-items: center; gap: 6px; padding: 8px 16px 10px; flex-wrap: wrap; }
.hint-label { font-size: 12px; color: var(--text-light); font-weight: 500; text-transform: uppercase; letter-spacing: 0.06em; }
.hint-chip {
    background: var(--bg-subtle); border: 1px solid var(--border); border-radius: 100px;
    padding: 4px 12px; font-family: var(--font-body); font-size: 13px;
    color: var(--text-muted); cursor: pointer; transition: all 0.2s ease;
}
.hint-chip:hover { background: var(--accent-light); color: var(--accent); border-color: var(--accent); }

/* ─── Loading ────────────────────────────────────────────────── */
.loading { text-align: center; padding: 48px 0; }
.loading__spinner {
    width: 36px; height: 36px; border: 3px solid var(--border);
    border-top-color: var(--accent); border-radius: 50%;
    animation: spin 0.8s linear infinite; margin: 0 auto 16px;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading__text { font-size: 15px; color: var(--text-muted); margin-bottom: 12px; }
.loading__stores { display: flex; justify-content: center; gap: 16px; }
.store-dot {
    font-size: 13px; font-weight: 500; padding: 4px 12px;
    border-radius: 100px; animation: pulse 1.5s ease-in-out infinite;
}
.store-dot--tesco { background: var(--tesco-light); color: #4d9fdf; animation-delay: 0s; }
.store-dot--sainsburys { background: var(--sainsburys-light); color: var(--sainsburys); animation-delay: 0.3s; }
.store-dot--aldi { background: var(--aldi-light); color: #6680b3; animation-delay: 0.6s; }
.store-dot--more { background: rgba(255,255,255,0.08); color: var(--text-muted); animation-delay: 0.9s; }
@keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.95); }
}

/* ─── Clarification Prompt ───────────────────────────────────── */
.clarification { padding: 24px 0; text-align: center; }
.clarification__label {
    font-size: 18px; font-weight: 600; color: var(--text); margin-bottom: 16px;
}
.clarification__chips { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
.clar-chip {
    font-family: var(--font-body); font-size: 15px; font-weight: 500;
    padding: 10px 22px; border: 1px solid var(--border);
    border-radius: 100px; background: var(--bg-card); color: var(--text);
    cursor: pointer; transition: all 0.2s ease;
}
.clar-chip:hover { border-color: var(--accent); background: var(--accent-light); color: var(--accent); }

/* ─── Compare Results ────────────────────────────────────────── */
.compare-results { margin-top: 8px; }

.cmp-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 12px; flex-wrap: wrap; gap: 8px;
}
.cmp-header__left { display: flex; flex-direction: column; gap: 2px; }
.cmp-variant { font-size: 15px; font-weight: 600; color: var(--text); }
.cmp-header__sub { font-size: 13px; color: var(--text-light); }
.cmp-change-btn {
    font-family: var(--font-body); font-size: 13px; color: var(--accent);
    background: none; border: none; cursor: pointer; text-decoration: underline; padding: 0;
}

.cmp-table { display: flex; flex-direction: column; gap: 6px; }
.cmp-empty { text-align: center; padding: 32px; color: var(--text-muted); font-size: 15px; }

.cmp-row {
    display: flex; align-items: center; gap: 12px;
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-md); padding: 14px 16px;
    text-decoration: none; color: var(--text);
    transition: box-shadow 0.2s, border-color 0.2s, transform 0.15s;
}
.cmp-row:hover { box-shadow: var(--shadow-md); transform: translateY(-1px); border-color: var(--border-hover); }
.cmp-row--cheapest { border-color: var(--cheapest); background: var(--cheapest-bg); }
.cmp-row--cheapest:hover { border-color: var(--cheapest); }

/* Store badge in compare row */
.cmp-store {
    font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
    padding: 3px 9px; border-radius: 100px; flex-shrink: 0; white-space: nowrap;
}
.cmp-store--tesco { background: var(--tesco-light); color: #4d9fdf; }
.cmp-store--sainsburys { background: var(--sainsburys-light); color: var(--sainsburys); }
.cmp-store--aldi { background: var(--aldi-light); color: #6680b3; }
.cmp-store--asda { background: var(--asda-light); color: var(--asda); }
.cmp-store--morrisons { background: var(--morrisons-light); color: var(--morrisons); }
.cmp-store--waitrose { background: var(--waitrose-light); color: var(--waitrose); }
.cmp-store--ocado { background: var(--ocado-light); color: var(--ocado); }
.cmp-store--coop { background: var(--coop-light); color: var(--coop); }
.cmp-store--other { background: var(--bg-subtle); color: var(--text-muted); }

.cmp-product { flex: 1; min-width: 0; }
.cmp-product__name {
    font-size: 14px; font-weight: 500; display: block;
    overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.cmp-product__weight { font-size: 11px; color: var(--text-light); }

.cmp-product__meta { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; margin-top: 1px; }
.cmp-sale {
    font-size: 10px; font-weight: 600; color: #4caf82;
    background: rgba(76, 175, 130, 0.15); padding: 1px 6px; border-radius: 4px;
}
.cmp-promo {
    font-size: 10px; font-weight: 600; color: var(--accent);
    background: var(--accent-light); padding: 1px 6px; border-radius: 4px;
}

.cmp-prices { text-align: right; flex-shrink: 0; }
.cmp-price { font-size: 18px; font-weight: 700; display: block; }
.cmp-price--struck { font-size: 13px; font-weight: 400; color: var(--text-light); text-decoration: line-through; display: block; }
.cmp-loyalty-price {
    display: flex; align-items: center; justify-content: flex-end; gap: 4px;
    font-size: 18px; font-weight: 700; color: var(--accent);
}
.cmp-loyalty-badge {
    font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
    padding: 2px 5px; border-radius: 3px; color: white;
}
.cmp-loyalty-badge--clubcard { background: var(--tesco); }
.cmp-loyalty-badge--nectar   { background: var(--sainsburys); }
.cmp-unit { font-size: 11px; color: var(--text-light); display: block; }

.cmp-badge {
    font-size: 9px; font-weight: 700; letter-spacing: 0.08em;
    background: var(--cheapest); color: white; padding: 3px 7px; border-radius: 4px;
    flex-shrink: 0;
}
.cmp-arrow { font-size: 18px; color: var(--text-light); flex-shrink: 0; transition: color 0.2s; }
.cmp-row:hover .cmp-arrow { color: var(--accent); }

/* ─── States ─────────────────────────────────────────────────── */
.empty-state, .error-state { text-align: center; padding: 64px 20px; }
.empty-state__icon, .error-state__icon { font-size: 48px; margin-bottom: 16px; }
.empty-state__text, .error-state__text { font-size: 16px; color: var(--text-muted); }

/* ═════════════════════════════════════════════════════════════════ */
/* MODE TOGGLE                                                       */
/* ═════════════════════════════════════════════════════════════════ */

.mode-toggle {
    display: flex; justify-content: center; gap: 4px;
    margin-bottom: 20px;
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: 100px; padding: 4px; width: fit-content; margin-left: auto; margin-right: auto;
}
.mode-toggle__btn {
    font-family: var(--font-body); font-size: 14px; font-weight: 500;
    padding: 8px 24px; border: none; border-radius: 100px;
    background: transparent; color: var(--text-muted); cursor: pointer;
    transition: all 0.2s ease;
}
.mode-toggle__btn:hover { color: var(--text); }
.mode-toggle__btn--active {
    background: var(--accent); color: #ffffff; font-weight: 600;
}

/* ═════════════════════════════════════════════════════════════════ */
/* BASKET MODE                                                       */
/* ═════════════════════════════════════════════════════════════════ */

/* ─── Store Selector ─────────────────────────────────────────── */
.store-selector {
    display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
    justify-content: center; margin-bottom: 16px;
}
.store-selector__label {
    font-size: 12px; color: var(--text-light); font-weight: 500;
    text-transform: uppercase; letter-spacing: 0.06em;
}
.store-check {
    display: flex; align-items: center; gap: 4px;
    font-size: 13px; color: var(--text-muted); cursor: pointer;
    padding: 4px 10px; border: 1px solid var(--border); border-radius: 100px;
    transition: all 0.2s ease;
}
.store-check:has(input:checked) {
    border-color: var(--accent); background: var(--accent-light); color: var(--text);
}
.store-check input { display: none; }
.store-check--tesco:has(input:checked) { border-color: #4d9fdf; background: var(--tesco-light); }
.store-check--sainsburys:has(input:checked) { border-color: var(--sainsburys); background: var(--sainsburys-light); }
.store-check--aldi:has(input:checked) { border-color: #6680b3; background: var(--aldi-light); }
.store-check--asda:has(input:checked) { border-color: var(--asda); background: var(--asda-light); }
.store-check--morrisons:has(input:checked) { border-color: var(--morrisons); background: var(--morrisons-light); }
.store-check--waitrose:has(input:checked) { border-color: var(--waitrose); background: var(--waitrose-light); }

/* ─── Basket Input Box ───────────────────────────────────────── */
.basket-box {
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-xl); padding: 12px;
    box-shadow: var(--shadow-md); transition: box-shadow 0.3s ease, border-color 0.3s ease;
}
.basket-box:focus-within { box-shadow: var(--shadow-lg); border-color: var(--accent); }

.basket-box__textarea {
    width: 100%; border: none; outline: none; background: transparent;
    font-family: var(--font-body); font-size: 15px; color: var(--text);
    padding: 8px 12px; resize: vertical; min-height: 120px;
    line-height: 1.6;
}
.basket-box__textarea::placeholder { color: var(--text-light); }
.basket-box__btn {
    display: block; width: 100%; margin-top: 8px;
    background: var(--accent); color: #ffffff; border: none;
    border-radius: calc(var(--radius-xl) - 6px);
    padding: 12px; font-family: var(--font-body); font-size: 15px;
    font-weight: 600; cursor: pointer; transition: background 0.2s ease, transform 0.15s ease;
}
.basket-box__btn:hover { background: var(--accent-hover); }
.basket-box__btn:active { transform: scale(0.98); }

/* ─── Basket Progress ────────────────────────────────────────── */
.basket-progress { padding: 32px 0; }
.basket-progress__fun {
    text-align: center; margin-bottom: 24px;
}
.basket-progress__msg {
    font-size: 16px; color: var(--accent); font-weight: 500;
    margin-top: 12px; animation: fadeMsg 0.4s ease;
}
@keyframes fadeMsg { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

.basket-progress__list { display: flex; flex-direction: column; gap: 6px; }

.bp-item {
    display: flex; align-items: center; gap: 10px;
    padding: 10px 14px; background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-sm); font-size: 14px;
}
.bp-item__icon { width: 24px; text-align: center; flex-shrink: 0; }
.bp-item__icon--pending { opacity: 0.3; }
.bp-item__icon--active { opacity: 1; }
.bp-item__icon--done { opacity: 1; }
.bp-item__icon--fail { opacity: 0.6; }
.bp-item__name { font-weight: 500; }

.loading__spinner--sm {
    width: 18px; height: 18px; border-width: 2px; margin: 0; display: inline-block;
}

/* ─── Basket Summary ─────────────────────────────────────────── */
.basket-summary { margin-bottom: 24px; }
.basket-summary__title {
    font-size: 17px; font-weight: 700; margin-bottom: 10px;
    padding-bottom: 6px; border-bottom: 1px solid var(--border-light);
}
.basket-summary__cards { display: flex; flex-direction: column; gap: 6px; }

.bs-card {
    display: flex; flex-direction: column; gap: 4px;
    padding: 14px 16px; background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-md);
}
.bs-card--cheapest { border-color: var(--cheapest); background: var(--cheapest-bg); }
.bs-card--incomplete { opacity: 0.7; }

.bs-card__header { display: flex; justify-content: space-between; align-items: center; }
.bs-card__store { font-size: 15px; font-weight: 600; display: flex; align-items: center; gap: 6px; }
.bs-card__store--tesco { color: #4d9fdf; }
.bs-card__store--sainsburys { color: var(--sainsburys); }
.bs-card__store--aldi { color: #6680b3; }
.bs-card__store--asda { color: var(--asda); }
.bs-card__store--morrisons { color: var(--morrisons); }
.bs-card__store--waitrose { color: var(--waitrose); }
.bs-card__store--ocado { color: var(--ocado); }
.bs-card__store--coop { color: var(--coop); }

.bs-card__tag {
    font-size: 9px; font-weight: 700; letter-spacing: 0.08em;
    background: var(--cheapest); color: white; padding: 2px 6px; border-radius: 4px;
}
.bs-card__total { font-size: 20px; font-weight: 700; }
.bs-card__meta { font-size: 12px; color: var(--text-muted); }
.bs-card__count { margin-right: 8px; }
.bs-card__missing { color: var(--text-light); font-style: italic; }

/* ─── Basket Ingredients ─────────────────────────────────────── */
.basket-ing__title {
    font-size: 17px; font-weight: 700; margin-bottom: 10px;
    padding-bottom: 6px; border-bottom: 1px solid var(--border-light);
}

.bi-row {
    margin-bottom: 12px; background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-md); overflow: hidden;
}
.bi-row__header {
    font-size: 14px; font-weight: 600; padding: 10px 14px;
    background: var(--bg-subtle); border-bottom: 1px solid var(--border-light);
    text-transform: capitalize;
}
.bi-row__empty { padding: 10px 14px; font-size: 13px; color: var(--text-light); }
.bi-row__stores { display: flex; flex-direction: column; }

.bi-store {
    display: flex; align-items: center; gap: 8px; padding: 8px 14px;
    border-bottom: 1px solid var(--border-light); font-size: 13px;
    flex-wrap: wrap;
}
.bi-store:last-child { border-bottom: none; }
.bi-store--cheapest { background: var(--cheapest-bg); }
.bi-store--missing { opacity: 0.4; }

.bi-store__name { font-weight: 600; min-width: 90px; }
.bi-store__name--tesco { color: #4d9fdf; }
.bi-store__name--sainsburys { color: var(--sainsburys); }
.bi-store__name--aldi { color: #6680b3; }
.bi-store__name--asda { color: var(--asda); }
.bi-store__name--morrisons { color: var(--morrisons); }
.bi-store__name--waitrose { color: var(--waitrose); }
.bi-store__name--ocado { color: var(--ocado); }
.bi-store__name--coop { color: var(--coop); }

.bi-store__price { font-weight: 700; min-width: 55px; display: flex; align-items: center; gap: 4px; flex-wrap: wrap; }
.bi-store__price--struck { font-weight: 400; color: var(--text-light); text-decoration: line-through; font-size: 11px; }
.bi-loyalty-badge {
    font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.04em;
    padding: 1px 4px; border-radius: 3px; color: white;
}
.bi-loyalty-badge--clubcard { background: var(--tesco); }
.bi-loyalty-badge--nectar   { background: var(--sainsburys); }
.basket-loyalty-note { font-size: 12px; color: var(--text-light); margin-top: 12px; font-style: italic; }
.bi-store__product { color: var(--text-muted); flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.bi-store__weight { color: var(--text-light); font-size: 11px; }
.bi-store__change {
    font-family: var(--font-body); font-size: 11px; color: var(--accent);
    background: none; border: none; cursor: pointer; text-decoration: underline;
    padding: 0;
}

/* ─── Basket Alternatives Picker ─────────────────────────────── */
.bi-alts { padding: 8px 14px; background: var(--bg-subtle); }
.bi-alts__label { font-size: 12px; color: var(--text-muted); margin-bottom: 6px; font-weight: 500; }
.bi-alts__list { display: flex; flex-direction: column; gap: 4px; }

.bi-alt-card {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 10px; background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius-sm); cursor: pointer; font-family: var(--font-body);
    color: var(--text); transition: border-color 0.2s; text-align: left; width: 100%;
}
.bi-alt-card:hover { border-color: var(--accent); }
.bi-alt-card--selected { border-color: var(--accent); background: var(--accent-light); }

.bi-alt-card__img {
    width: 36px; height: 36px; border-radius: 6px;
    object-fit: contain; background: var(--bg-subtle); flex-shrink: 0;
}
.bi-alt-card__info { flex: 1; min-width: 0; }
.bi-alt-card__name { font-size: 12px; font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; display: block; }
.bi-alt-card__price { font-size: 13px; font-weight: 700; }
.bi-alt-card__weight { font-size: 10px; color: var(--text-light); margin-left: 4px; }
.bi-alt-card__unit { font-size: 10px; color: var(--text-light); margin-left: 4px; }
.bi-alt-card__check { color: var(--accent); font-weight: 700; font-size: 16px; flex-shrink: 0; }

/* ─── Basket Reset Button ────────────────────────────────────── */
.basket-reset-btn {
    display: block; width: 100%; margin-top: 20px;
    padding: 12px; font-family: var(--font-body); font-size: 14px; font-weight: 500;
    background: var(--bg-subtle); color: var(--text-muted); border: 1px solid var(--border);
    border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease;
}
.basket-reset-btn:hover { border-color: var(--accent); color: var(--accent); }

/* ─── Footer ─────────────────────────────────────────────────── */
.footer { text-align: center; padding: 32px 0; border-top: 1px solid var(--border); margin-top: 32px; }
.footer p { font-size: 12px; color: var(--text-light); margin-bottom: 4px; }
.footer a { color: var(--accent); text-decoration: none; }
.footer a:hover { color: var(--accent-hover); text-decoration: underline; }

/* ─── Responsive ─────────────────────────────────────────────── */
@media (max-width: 640px) {
    .app { padding: 0 12px; }
    .logo__text { font-size: 22px; }
    .search-box__btn { padding: 12px 18px; font-size: 14px; }
    .search-box__hints { display: none; }
    .cmp-row { padding: 12px; gap: 8px; }
    .cmp-product__name { font-size: 13px; }
    .cmp-price { font-size: 16px; }
    .store-selector { gap: 4px; }
    .store-check { font-size: 11px; padding: 3px 8px; }
    .bi-store__name { min-width: 70px; }
    .bi-store__product { display: none; }
    .bs-card__total { font-size: 18px; }
}
